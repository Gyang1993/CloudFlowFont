{"remainingRequest":"C:\\Users\\Administrator\\WebstormProjects\\workviewer\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\WebstormProjects\\workviewer\\src\\utils\\menuList.js","dependencies":[{"path":"C:\\Users\\Administrator\\WebstormProjects\\workviewer\\src\\utils\\menuList.js","mtime":1640241390935},{"path":"C:\\Users\\Administrator\\WebstormProjects\\workviewer\\babel.config.js","mtime":1639559223901},{"path":"C:\\Users\\Administrator\\WebstormProjects\\workviewer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1639559218056},{"path":"C:\\Users\\Administrator\\WebstormProjects\\workviewer\\node_modules\\babel-loader\\lib\\index.js","mtime":1639559218905}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IHsgZ2V0UmVxdWVzdCB9IGZyb20gIi4vYXBpIjsKaW1wb3J0IHJvdXRlciBmcm9tICIuLi9yb3V0ZXIiOyAvLyDliJ3lp4vljJboj5zljZUKCmV4cG9ydCB2YXIgaW5pdE1lbnUgPSBmdW5jdGlvbiBpbml0TWVudShyb3V0ZXIsIHN0b3JlKSB7CiAgaWYgKHN0b3JlLnN0YXRlLnJvdXRlcy5sZW5ndGggPiAwKSB7CiAgICAvLyDlt7LlrZjlnKgKICAgIHJldHVybjsKICB9CgogIGdldFJlcXVlc3QoJy9zeXN0ZW0vY2ZnL21lbnUnKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICBpZiAoZGF0YSkgewogICAgICAvLyDmoLzlvI/ljJZSb3V0ZXIKICAgICAgdmFyIGZtdFJvdXRlcyA9IGZvcm1hdFJvdXRlcyhkYXRhKTsgLy8g5re75Yqg5YiwUm91dGVyCgogICAgICByb3V0ZXIuYWRkUm91dGVzKGZtdFJvdXRlcyk7IC8vIOWwhuaVsOaNruWtmOWFpXZ1ZXgKCiAgICAgIHN0b3JlLmNvbW1pdCgnaW5pdFJvdXRlcycsIGZtdFJvdXRlcyk7CiAgICB9CiAgfSk7Cn07CmV4cG9ydCB2YXIgZm9ybWF0Um91dGVzID0gZnVuY3Rpb24gZm9ybWF0Um91dGVzKHJvdXRlcykgewogIHZhciBmbXRSb3V0ZXMgPSBbXTsKICByb3V0ZXMuZm9yRWFjaChmdW5jdGlvbiAocm91dGVyKSB7CiAgICB2YXIgcGF0aCA9IHJvdXRlci5wYXRoLAogICAgICAgIF9jb21wb25lbnQgPSByb3V0ZXIuY29tcG9uZW50LAogICAgICAgIG5hbWUgPSByb3V0ZXIubmFtZSwKICAgICAgICBpY29uQ2xzID0gcm91dGVyLmljb25DbHMsCiAgICAgICAgY2hpbGRyZW4gPSByb3V0ZXIuY2hpbGRyZW47CgogICAgaWYgKGNoaWxkcmVuICYmIGNoaWxkcmVuIGluc3RhbmNlb2YgQXJyYXkpIHsKICAgICAgLy8g6YCS5b2SCiAgICAgIGNoaWxkcmVuID0gZm9ybWF0Um91dGVzKGNoaWxkcmVuKTsKICAgIH0KCiAgICB2YXIgZm1Sb3V0ZXIgPSB7CiAgICAgIHBhdGg6IHBhdGgsCiAgICAgIG5hbWU6IG5hbWUsCiAgICAgIGljb25DbHM6IGljb25DbHMsCiAgICAgIGNoaWxkcmVuOiBjaGlsZHJlbiwKICAgICAgY29tcG9uZW50OiBmdW5jdGlvbiBjb21wb25lbnQocmVzb2x2ZSkgewogICAgICAgIC8vIOaMieeFp+e7hOS7tuWQjeWumuS9jeebruW9leW5tuWvu+aJvuiPnOWNlQogICAgICAgIGlmIChfY29tcG9uZW50LnN0YXJ0V2l0aCgnRW1wJykpIHsKICAgICAgICAgIHJlcXVpcmUoWycuLi92aWV3cy9lbXAvJyArIF9jb21wb25lbnQgKyAnLnZ1ZSddLCByZXNvbHZlKTsKICAgICAgICB9IGVsc2UgaWYgKF9jb21wb25lbnQuc3RhcnRXaXRoKCdQZXInKSkgewogICAgICAgICAgcmVxdWlyZShbJy4uL3ZpZXdzL3Blci8nICsgX2NvbXBvbmVudCArICcudnVlJ10sIHJlc29sdmUpOwogICAgICAgIH0gZWxzZSBpZiAoX2NvbXBvbmVudC5zdGFydFdpdGgoJ1NhbCcpKSB7CiAgICAgICAgICByZXF1aXJlKFsnLi4vdmlld3Mvc2FsLycgKyBfY29tcG9uZW50ICsgJy52dWUnXSwgcmVzb2x2ZSk7CiAgICAgICAgfSBlbHNlIGlmIChfY29tcG9uZW50LnN0YXJ0V2l0aCgnU3RhJykpIHsKICAgICAgICAgIHJlcXVpcmUoWycuLi92aWV3cy9zdGEvJyArIF9jb21wb25lbnQgKyAnLnZ1ZSddLCByZXNvbHZlKTsKICAgICAgICB9IGVsc2UgaWYgKF9jb21wb25lbnQuc3RhcnRXaXRoKCdTeXMnKSkgewogICAgICAgICAgcmVxdWlyZShbJy4uL3ZpZXdzL3N5cy8nICsgX2NvbXBvbmVudCArICcudnVlJ10sIHJlc29sdmUpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIGZtdFJvdXRlcy5wdXNoKGZtUm91dGVyKTsKICB9KTsKICByZXR1cm4gZm10Um91dGVzOwp9Ow=="},{"version":3,"sources":["C:/Users/Administrator/WebstormProjects/workviewer/src/utils/menuList.js"],"names":["getRequest","router","initMenu","store","state","routes","length","then","data","fmtRoutes","formatRoutes","addRoutes","commit","forEach","path","component","name","iconCls","children","Array","fmRouter","resolve","startWith","require","push"],"mappings":";;;AAAA,SAAQA,UAAR,QAAyB,OAAzB;AACA,OAAOC,MAAP,MAAmB,WAAnB,C,CAEA;;AACA,OAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACD,MAAD,EAASE,KAAT,EAAmB;AACvC,MAAGA,KAAK,CAACC,KAAN,CAAYC,MAAZ,CAAmBC,MAAnB,GAA2B,CAA9B,EAAiC;AAAE;AAC/B;AACH;;AAEDN,EAAAA,UAAU,CAAC,kBAAD,CAAV,CAA+BO,IAA/B,CAAoC,UAAAC,IAAI,EAAE;AACtC,QAAGA,IAAH,EAAS;AACL;AACA,UAAIC,SAAS,GAAGC,YAAY,CAACF,IAAD,CAA5B,CAFK,CAGL;;AACAP,MAAAA,MAAM,CAACU,SAAP,CAAiBF,SAAjB,EAJK,CAKL;;AACAN,MAAAA,KAAK,CAACS,MAAN,CAAa,YAAb,EAA2BH,SAA3B;AACH;AACJ,GATD;AAUH,CAfM;AAiBP,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACL,MAAD,EAAW;AACnC,MAAII,SAAS,GAAG,EAAhB;AACAJ,EAAAA,MAAM,CAACQ,OAAP,CAAe,UAAAZ,MAAM,EAAE;AACnB,QACIa,IADJ,GAMIb,MANJ,CACIa,IADJ;AAAA,QAEIC,UAFJ,GAMId,MANJ,CAEIc,SAFJ;AAAA,QAGIC,IAHJ,GAMIf,MANJ,CAGIe,IAHJ;AAAA,QAIIC,OAJJ,GAMIhB,MANJ,CAIIgB,OAJJ;AAAA,QAKIC,QALJ,GAMIjB,MANJ,CAKIiB,QALJ;;AAOA,QAAGA,QAAQ,IAAIA,QAAQ,YAAYC,KAAnC,EAA0C;AACtC;AACAD,MAAAA,QAAQ,GAAGR,YAAY,CAACQ,QAAD,CAAvB;AACH;;AACD,QAAIE,QAAQ,GAAG;AACXN,MAAAA,IAAI,EAACA,IADM;AAEXE,MAAAA,IAAI,EAACA,IAFM;AAGXC,MAAAA,OAAO,EAACA,OAHG;AAIXC,MAAAA,QAAQ,EAACA,QAJE;AAKXH,MAAAA,SALW,qBAKDM,OALC,EAKQ;AACf;AACA,YAAGN,UAAS,CAACO,SAAV,CAAoB,KAApB,CAAH,EAA+B;AAC3BC,UAAAA,OAAO,CAAC,CAAC,kBAAkBR,UAAlB,GAA8B,MAA/B,CAAD,EAAyCM,OAAzC,CAAP;AACH,SAFD,MAEM,IAAGN,UAAS,CAACO,SAAV,CAAoB,KAApB,CAAH,EAA+B;AACjCC,UAAAA,OAAO,CAAC,CAAC,kBAAkBR,UAAlB,GAA8B,MAA/B,CAAD,EAAyCM,OAAzC,CAAP;AACH,SAFK,MAEA,IAAGN,UAAS,CAACO,SAAV,CAAoB,KAApB,CAAH,EAA+B;AACjCC,UAAAA,OAAO,CAAC,CAAC,kBAAkBR,UAAlB,GAA8B,MAA/B,CAAD,EAAyCM,OAAzC,CAAP;AACH,SAFK,MAEA,IAAGN,UAAS,CAACO,SAAV,CAAoB,KAApB,CAAH,EAA+B;AACjCC,UAAAA,OAAO,CAAC,CAAC,kBAAkBR,UAAlB,GAA8B,MAA/B,CAAD,EAAyCM,OAAzC,CAAP;AACH,SAFK,MAEA,IAAGN,UAAS,CAACO,SAAV,CAAoB,KAApB,CAAH,EAA+B;AACjCC,UAAAA,OAAO,CAAC,CAAC,kBAAkBR,UAAlB,GAA8B,MAA/B,CAAD,EAAyCM,OAAzC,CAAP;AACH;AACJ;AAlBU,KAAf;AAoBAZ,IAAAA,SAAS,CAACe,IAAV,CAAeJ,QAAf;AACH,GAjCD;AAkCA,SAAOX,SAAP;AACH,CArCM","sourcesContent":["import {getRequest} from \"./api\";\r\nimport router from \"../router\";\r\n\r\n// 初始化菜单\r\nexport const initMenu = (router, store) => {\r\n    if(store.state.routes.length >0) { // 已存在\r\n        return;\r\n    }\r\n\r\n    getRequest('/system/cfg/menu').then(data=>{\r\n        if(data) {\r\n            // 格式化Router\r\n            let fmtRoutes = formatRoutes(data);\r\n            // 添加到Router\r\n            router.addRoutes(fmtRoutes);\r\n            // 将数据存入vuex\r\n            store.commit('initRoutes', fmtRoutes);\r\n        }\r\n    })\r\n}\r\n\r\nexport const formatRoutes = (routes) =>{\r\n    let fmtRoutes = [];\r\n    routes.forEach(router=>{\r\n        let{\r\n            path,\r\n            component,\r\n            name,\r\n            iconCls,\r\n            children\r\n        } = router;\r\n        if(children && children instanceof Array) {\r\n            // 递归\r\n            children = formatRoutes(children);\r\n        }\r\n        let fmRouter = {\r\n            path:path,\r\n            name:name,\r\n            iconCls:iconCls,\r\n            children:children,\r\n            component(resolve) {\r\n                // 按照组件名定位目录并寻找菜单\r\n                if(component.startWith('Emp')) {\r\n                    require(['../views/emp/' + component + '.vue'], resolve);\r\n                }else if(component.startWith('Per')) {\r\n                    require(['../views/per/' + component + '.vue'], resolve);\r\n                }else if(component.startWith('Sal')) {\r\n                    require(['../views/sal/' + component + '.vue'], resolve);\r\n                }else if(component.startWith('Sta')) {\r\n                    require(['../views/sta/' + component + '.vue'], resolve);\r\n                }else if(component.startWith('Sys')) {\r\n                    require(['../views/sys/' + component + '.vue'], resolve);\r\n                }\r\n            }\r\n        }\r\n        fmtRoutes.push(fmRouter)\r\n    });\r\n    return fmtRoutes;\r\n}"]}]}